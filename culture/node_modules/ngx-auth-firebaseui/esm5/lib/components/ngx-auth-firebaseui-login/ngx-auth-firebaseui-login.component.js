import { __awaiter, __decorate, __generator, __param } from "tslib";
import { Component, EventEmitter, Inject, Input, Output, PLATFORM_ID, ViewEncapsulation } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { AuthProcessService, AuthProvider } from '../../services';
import { NgxAuthFirebaseuiAnimations } from '../../animations';
import { isPlatformBrowser } from '@angular/common';
var NgxAuthFirebaseuiLoginComponent = /** @class */ (function () {
    function NgxAuthFirebaseuiLoginComponent(platformId, authProcess, formBuilder) {
        this.platformId = platformId;
        this.authProcess = authProcess;
        this.formBuilder = formBuilder;
        this.providers = AuthProvider.ALL; //  google, facebook, twitter, github as array or all as one single string
        this.registrationEnabled = true;
        this.resetPasswordEnabled = true;
        // i18n
        this.titleText = 'LOGIN TO YOUR ACCOUNT';
        this.rememberMeText = 'Remember Me';
        this.loginButtonText = 'LOGIN';
        this.orLabelText = 'OR';
        this.forgotPasswordText = 'Forgot Password?';
        this.dontHaveAnAccountText = 'Don\'t have an account?';
        this.createAccountButtonText = 'Create an account';
        // i18n email
        this.emailText = 'Email';
        this.emailErrorRequiredText = 'Email is required';
        this.emailErrorPatternText = 'Please enter a valid email address';
        // i18n password
        this.passwordText = 'Password';
        this.passwordErrorRequiredText = 'Password is required';
        // tslint:disable-next-line:no-output-on-prefix
        this.onCreateAccountRequested = new EventEmitter();
        // tslint:disable-next-line:no-output-on-prefix
        this.onResetPasswordRequested = new EventEmitter();
        this.authProviders = AuthProvider;
        this.authenticationError = false;
        this.onSuccess = authProcess.onSuccessEmitter;
        this.onError = authProcess.onErrorEmitter;
    }
    Object.defineProperty(NgxAuthFirebaseuiLoginComponent.prototype, "color", {
        get: function () {
            return this.authenticationError ? 'warn' : 'primary';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NgxAuthFirebaseuiLoginComponent.prototype, "colorAccent", {
        get: function () {
            return this.authenticationError ? 'warn' : 'accent';
        },
        enumerable: true,
        configurable: true
    });
    NgxAuthFirebaseuiLoginComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (isPlatformBrowser(this.platformId)) {
            this.onErrorSubscription = this.onError.subscribe(function () { return _this.authenticationError = true; });
        }
        this.updateAuthSnackbarMessages();
        this.loginForm = this.formBuilder.group({
            email: ['', [Validators.required, Validators.email]],
            password: ['', Validators.required]
        });
    };
    NgxAuthFirebaseuiLoginComponent.prototype.updateAuthSnackbarMessages = function () {
        this.authProcess.messageOnAuthSuccess = this.messageOnAuthSuccess;
        this.authProcess.messageOnAuthError = this.messageOnAuthError;
    };
    NgxAuthFirebaseuiLoginComponent.prototype.login = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.authProcess.signInWith(this.authProviders.EmailAndPassword, {
                            email: this.loginForm.controls.email.value,
                            password: this.loginForm.controls.password.value
                        })];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    NgxAuthFirebaseuiLoginComponent.ctorParameters = function () { return [
        { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
        { type: AuthProcessService },
        { type: FormBuilder }
    ]; };
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "logoUrl", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "providers", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "appearance", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "registrationEnabled", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "resetPasswordEnabled", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "messageOnAuthSuccess", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "messageOnAuthError", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "titleText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "rememberMeText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "loginButtonText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "orLabelText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "forgotPasswordText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "dontHaveAnAccountText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "createAccountButtonText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "emailText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "emailErrorRequiredText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "emailErrorPatternText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "passwordText", void 0);
    __decorate([
        Input()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "passwordErrorRequiredText", void 0);
    __decorate([
        Output()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "onSuccess", void 0);
    __decorate([
        Output()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "onError", void 0);
    __decorate([
        Output()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "onCreateAccountRequested", void 0);
    __decorate([
        Output()
    ], NgxAuthFirebaseuiLoginComponent.prototype, "onResetPasswordRequested", void 0);
    NgxAuthFirebaseuiLoginComponent = __decorate([
        Component({
            selector: 'ngx-auth-firebaseui-login',
            template: "<div fxLayout=\"column\" id=\"login\">\n\n  <div fxLayout=\"column\" fxLayoutAlign=\"center center\" id=\"login-form-wrapper\">\n\n    <div [@animateStagger]=\"{ value: '50' }\" id=\"login-form\">\n\n      <div *ngIf=\"logoUrl\" class=\"logo\">\n        <img [@animate]=\"{ value: '*', params: { x: '50px' } }\" [src]=\"logoUrl\" alt=\"logo\">\n      </div>\n\n      <div [@animate]=\"{ value: '*', params: { x: '-50px' } }\" class=\"title\">{{titleText}}</div>\n\n      <form [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\" [formGroup]=\"loginForm\" name=\"loginForm\"\n            novalidate>\n\n        <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\" [appearance]=\"appearance\">\n          <input [placeholder]=\"emailText\" formControlName=\"email\" matInput>\n          <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n          <mat-error *ngIf=\"loginForm.get('email')?.hasError('required')\">\n            {{emailErrorRequiredText}}\n          </mat-error>\n          <mat-error\n            *ngIf=\"!loginForm.get('email')?.hasError('required') &&\n                                loginForm.get('email')?.hasError('email')\">\n            {{emailErrorPatternText}}\n          </mat-error>\n        </mat-form-field>\n\n        <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\" [appearance]=\"appearance\">\n          <input [placeholder]=\"passwordText\" formControlName=\"password\" matInput type=\"password\">\n          <mat-icon [color]=\"color\" matSuffix>lock</mat-icon>\n          <mat-error>\n            {{passwordErrorRequiredText}}\n          </mat-error>\n        </mat-form-field>\n\n        <div [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n             class=\"remember-forgot-password\" fxLayout=\"row\"\n             fxLayout.xs=\"column\"\n             fxLayoutAlign=\"space-between center\">\n          <!--          <mat-checkbox class=\"remember-me\" aria-label=\"Remember Me\">-->\n          <!--            {{rememberMeText}}-->\n          <!--          </mat-checkbox>-->\n\n          <button (click)=\"onResetPasswordRequested.emit()\"\n                  *ngIf=\"resetPasswordEnabled\"\n                  [@animate]=\"{ value: '*', params: { x: '-50px' } }\"\n                  [color]=\"color\"\n                  class=\"forgot-password\"\n                  mat-button\n                  type=\"button\">\n            {{forgotPasswordText}}\n          </button>\n        </div>\n\n        <button (click)=\"login()\"\n                [color]=\"colorAccent\"\n                [disabled]=\"loginForm.invalid\"\n                aria-label=\"LOG IN\"\n                class=\"submit-button\"\n                id=\"loginButton\"\n                mat-raised-button>\n          {{loginButtonText}}\n        </button>\n\n      </form>\n\n      <div *ngIf=\"providers.length > 0\"\n           [@animate]=\"{ value: '*', params: { z: '50px', delay: '50ms', scale: '0.2' } }\"\n           class=\"separator\">\n        <span class=\"text\">{{orLabelText}}</span>\n      </div>\n\n      <ngx-auth-firebaseui-providers [providers]=\"providers\"\n                                     fxLayoutAlign=\"center center\"\n                                     layout=\"column\"\n                                     theme=\"raised\"></ngx-auth-firebaseui-providers>\n\n      <div *ngIf=\"registrationEnabled\"\n           [@animateStagger]=\"{ value: '100' }\"\n           class=\"register\"\n           fxLayout=\"column\" fxLayoutAlign=\"center center\">\n        <span [@animate]=\"{ value: '*', params: { x: '100px' } }\" class=\"text\">\n          {{dontHaveAnAccountText}}\n        </span>\n        <button (click)=\"onCreateAccountRequested.emit()\"\n                [@animate]=\"{ value: '*', params: { x: '-100px' } }\"\n                [color]=\"color\"\n                id=\"createAccountButton\"\n                mat-button\n                type=\"button\">{{createAccountButtonText}}</button>\n      </div>\n    </div>\n  </div>\n</div>\n",
            encapsulation: ViewEncapsulation.None,
            animations: NgxAuthFirebaseuiAnimations,
            styles: ["ngx-auth-firebaseui-login #login-form-wrapper{-webkit-box-flex:1;flex:1 0 auto;padding:32px}ngx-auth-firebaseui-login #login-form-wrapper #login-form{width:384px;max-width:384px;padding:32px;text-align:center}ngx-auth-firebaseui-login #login-form-wrapper #login-form .logo{width:150px;height:150px;margin:32px auto}ngx-auth-firebaseui-login #login-form-wrapper #login-form .title{font-size:20px;margin:16px 0 32px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form{width:100%;text-align:left}ngx-auth-firebaseui-login #login-form-wrapper #login-form form mat-form-field{width:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form form mat-checkbox{margin:0}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .remember-forgot-password{font-size:13px;margin-top:8px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .remember-forgot-password .remember-me{margin-bottom:16px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .remember-forgot-password .forgot-password{font-size:13px;font-weight:500;margin-bottom:16px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .submit-button{width:220px;margin:16px auto;display:block}@media screen and (max-width:599px){ngx-auth-firebaseui-login #login-form-wrapper{padding:16px}ngx-auth-firebaseui-login #login-form-wrapper #login-form{padding:24px;width:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .submit-button{width:90%}ngx-auth-firebaseui-login #login-form-wrapper #login-form button{width:80%}}ngx-auth-firebaseui-login #login-form-wrapper #login-form .register{margin:32px auto 24px;font-weight:500}ngx-auth-firebaseui-login #login-form-wrapper #login-form .register .text{margin-right:8px}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator{font-size:15px;font-weight:600;margin:24px auto;position:relative;overflow:hidden;width:100px}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text{display:-webkit-inline-box;display:inline-flex;position:relative;padding:0 8px;z-index:9999}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:after,ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:before{content:\"\";display:block;width:30px;position:absolute;top:10px;border-top:1px solid}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:before{right:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:after{left:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form button.facebook-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.github-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.google-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.microsoft-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.twitter-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.yahoo-raised{width:192px;text-transform:none;color:#fff;font-size:13px;margin-bottom:8px}"]
        }),
        __param(0, Inject(PLATFORM_ID))
    ], NgxAuthFirebaseuiLoginComponent);
    return NgxAuthFirebaseuiLoginComponent;
}());
export { NgxAuthFirebaseuiLoginComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtYXV0aC1maXJlYmFzZXVpLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbi9uZ3gtYXV0aC1maXJlYmFzZXVpLWxvZ2luLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsV0FBVyxFQUFFLGlCQUFpQixFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3JILE9BQU8sRUFBQyxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ2xFLE9BQU8sRUFBQyxrQkFBa0IsRUFBRSxZQUFZLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUVoRSxPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUM3RCxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQVdsRDtJQTJDRSx5Q0FDK0IsVUFBa0IsRUFDeEMsV0FBK0IsRUFDOUIsV0FBd0I7UUFGSCxlQUFVLEdBQVYsVUFBVSxDQUFRO1FBQ3hDLGdCQUFXLEdBQVgsV0FBVyxDQUFvQjtRQUM5QixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQTNDekIsY0FBUyxHQUFzQixZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsMEVBQTBFO1FBRTNILHdCQUFtQixHQUFHLElBQUksQ0FBQztRQUMzQix5QkFBb0IsR0FBRyxJQUFJLENBQUM7UUFJckMsT0FBTztRQUNFLGNBQVMsR0FBRyx1QkFBdUIsQ0FBQztRQUNwQyxtQkFBYyxHQUFHLGFBQWEsQ0FBQztRQUMvQixvQkFBZSxHQUFHLE9BQU8sQ0FBQztRQUMxQixnQkFBVyxHQUFHLElBQUksQ0FBQztRQUNuQix1QkFBa0IsR0FB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LEVBQUU7aUZBQThCO0lBQzdCO1FBQVIsS0FBSyxFQUFFOytFQUE0QjtJQUczQjtRQUFSLEtBQUssRUFBRTtzRUFBcUM7SUFDcEM7UUFBUixLQUFLLEVBQUU7MkVBQWdDO0lBQy9CO1FBQVIsS0FBSyxFQUFFOzRFQUEyQjtJQUMxQjtRQUFSLEtBQUssRUFBRTt3RUFBb0I7SUFDbkI7UUFBUixLQUFLLEVBQUU7K0VBQXlDO0lBQ3hDO1FBQVIsS0FBSyxFQUFFO2tGQUFtRDtJQUNsRDtRQUFSLEtBQUssRUFBRTtvRkFBK0M7SUFHOUM7UUFBUixLQUFLLEVBQUU7c0VBQXFCO0lBQ3BCO1FBQVIsS0FBSyxFQUFFO21GQUE4QztJQUM3QztRQUFSLEtBQUssRUFBRTtrRkFBOEQ7SUFHN0Q7UUFBUixLQUFLLEVBQUU7eUVBQTJCO0lBQzFCO1FBQVIsS0FBSyxFQUFFO3NGQUFvRDtJQUlsRDtRQUFULE1BQU0sRUFBRTtzRUFBZ0I7SUFFZjtRQUFULE1BQU0sRUFBRTtvRUFBYztJQUViO1FBQVQsTUFBTSxFQUFFO3FGQUF5RTtJQUV4RTtRQUFULE1BQU0sRUFBRTtxRkFBeUU7SUFwQ3ZFLCtCQUErQjtRQVAzQyxTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsMkJBQTJCO1lBQ3JDLG05SEFBeUQ7WUFFekQsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUk7WUFDckMsVUFBVSxFQUFFLDJCQUEyQjs7U0FDeEMsQ0FBQztRQTZDRyxXQUFBLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQTtPQTVDWCwrQkFBK0IsQ0FzRjNDO0lBQUQsc0NBQUM7Q0FBQSxBQXRGRCxJQXNGQztTQXRGWSwrQkFBK0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbmplY3QsIElucHV0LCBPbkluaXQsIE91dHB1dCwgUExBVEZPUk1fSUQsIFZpZXdFbmNhcHN1bGF0aW9ufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7Rm9ybUJ1aWxkZXIsIEZvcm1Hcm91cCwgVmFsaWRhdG9yc30gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHtBdXRoUHJvY2Vzc1NlcnZpY2UsIEF1dGhQcm92aWRlcn0gZnJvbSAnLi4vLi4vc2VydmljZXMnO1xuaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtOZ3hBdXRoRmlyZWJhc2V1aUFuaW1hdGlvbnN9IGZyb20gJy4uLy4uL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHtpc1BsYXRmb3JtQnJvd3Nlcn0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7TWF0Rm9ybUZpZWxkQXBwZWFyYW5jZX0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZm9ybS1maWVsZCc7XG5pbXBvcnQge1RoZW1lUGFsZXR0ZX0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvY29yZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25neC1hdXRoLWZpcmViYXNldWktbG9naW4nLFxuICB0ZW1wbGF0ZVVybDogJy4vbmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbi5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL25neC1hdXRoLWZpcmViYXNldWktbG9naW4uY29tcG9uZW50LnNjc3MnXSxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgYW5pbWF0aW9uczogTmd4QXV0aEZpcmViYXNldWlBbmltYXRpb25zXG59KVxuZXhwb3J0IGNsYXNzIE5neEF1dGhGaXJlYmFzZXVpTG9naW5Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuXG4gIEBJbnB1dCgpIGxvZ29Vcmw6IHN0cmluZztcbiAgQElucHV0KCkgcHJvdmlkZXJzOiBzdHJpbmdbXSB8IHN0cmluZyA9IEF1dGhQcm92aWRlci5BTEw7IC8vICBnb29nbGUsIGZhY2Vib29rLCB0d2l0dGVyLCBnaXRodWIgYXMgYXJyYXkgb3IgYWxsIGFzIG9uZSBzaW5nbGUgc3RyaW5nXG4gIEBJbnB1dCgpIGFwcGVhcmFuY2U6IE1hdEZvcm1GaWVsZEFwcGVhcmFuY2U7XG4gIEBJbnB1dCgpIHJlZ2lzdHJhdGlvbkVuYWJsZWQgPSB0cnVlO1xuICBASW5wdXQoKSByZXNldFBhc3N3b3JkRW5hYmxlZCA9IHRydWU7XG4gIEBJbnB1dCgpIG1lc3NhZ2VPbkF1dGhTdWNjZXNzOiBzdHJpbmc7XG4gIEBJbnB1dCgpIG1lc3NhZ2VPbkF1dGhFcnJvcjogc3RyaW5nO1xuXG4gIC8vIGkxOG5cbiAgQElucHV0KCkgdGl0bGVUZXh0ID0gJ0xPR0lOIFRPIFlPVVIgQUNDT1VOVCc7XG4gIEBJbnB1dCgpIHJlbWVtYmVyTWVUZXh0ID0gJ1JlbWVtYmVyIE1lJztcbiAgQElucHV0KCkgbG9naW5CdXR0b25UZXh0ID0gJ0xPR0lOJztcbiAgQElucHV0KCkgb3JMYWJlbFRleHQgPSAnT1InO1xuICBASW5wdXQoKSBmb3Jnb3RQYXNzd29yZFRleHQgPSAnRm9yZ290IFBhc3N3b3JkPyc7XG4gIEBJbnB1dCgpIGRvbnRIYXZlQW5BY2NvdW50VGV4dCA9ICdEb25cXCd0IGhhdmUgYW4gYWNjb3VudD8nO1xuICBASW5wdXQoKSBjcmVhdGVBY2NvdW50QnV0dG9uVGV4dCA9ICdDcmVhdGUgYW4gYWNjb3VudCc7XG5cbiAgLy8gaTE4biBlbWFpbFxuICBASW5wdXQoKSBlbWFpbFRleHQgPSAnRW1haWwnO1xuICBASW5wdXQoKSBlbWFpbEVycm9yUmVxdWlyZWRUZXh0ID0gJ0VtYWlsIGlzIHJlcXVpcmVkJztcbiAgQElucHV0KCkgZW1haWxFcnJvclBhdHRlcm5UZXh0ID0gJ1BsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MnO1xuXG4gIC8vIGkxOG4gcGFzc3dvcmRcbiAgQElucHV0KCkgcGFzc3dvcmRUZXh0ID0gJ1Bhc3N3b3JkJztcbiAgQElucHV0KCkgcGFzc3dvcmRFcnJvclJlcXVpcmVkVGV4dCA9ICdQYXNzd29yZCBpcyByZXF1aXJlZCc7XG5cbiAgLy8gRXZlbnRzXG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1vdXRwdXQtb24tcHJlZml4XG4gIEBPdXRwdXQoKSBvblN1Y2Nlc3M6IGFueTtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW91dHB1dC1vbi1wcmVmaXhcbiAgQE91dHB1dCgpIG9uRXJyb3I6IGFueTtcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW91dHB1dC1vbi1wcmVmaXhcbiAgQE91dHB1dCgpIG9uQ3JlYXRlQWNjb3VudFJlcXVlc3RlZDogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxuICBAT3V0cHV0KCkgb25SZXNldFBhc3N3b3JkUmVxdWVzdGVkOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgbG9naW5Gb3JtOiBGb3JtR3JvdXA7XG4gIGF1dGhQcm92aWRlcnMgPSBBdXRoUHJvdmlkZXI7XG4gIG9uRXJyb3JTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgYXV0aGVudGljYXRpb25FcnJvciA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxuICAgIHB1YmxpYyBhdXRoUHJvY2VzczogQXV0aFByb2Nlc3NTZXJ2aWNlLFxuICAgIHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyKSB7XG4gICAgdGhpcy5vblN1Y2Nlc3MgPSBhdXRoUHJvY2Vzcy5vblN1Y2Nlc3NFbWl0dGVyO1xuICAgIHRoaXMub25FcnJvciA9IGF1dGhQcm9jZXNzLm9uRXJyb3JFbWl0dGVyO1xuICB9XG5cbiAgZ2V0IGNvbG9yKCk6IHN0cmluZyB8IFRoZW1lUGFsZXR0ZSB7XG4gICAgcmV0dXJuIHRoaXMuYXV0aGVudGljYXRpb25FcnJvciA/ICd3YXJuJyA6ICdwcmltYXJ5JztcbiAgfVxuXG4gIGdldCBjb2xvckFjY2VudCgpOiBzdHJpbmcgfCBUaGVtZVBhbGV0dGUge1xuICAgIHJldHVybiB0aGlzLmF1dGhlbnRpY2F0aW9uRXJyb3IgPyAnd2FybicgOiAnYWNjZW50JztcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuXG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIHRoaXMub25FcnJvclN1YnNjcmlwdGlvbiA9IHRoaXMub25FcnJvci5zdWJzY3JpYmUoKCkgPT4gdGhpcy5hdXRoZW50aWNhdGlvbkVycm9yID0gdHJ1ZSk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVBdXRoU25hY2tiYXJNZXNzYWdlcygpO1xuXG4gICAgdGhpcy5sb2dpbkZvcm0gPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHtcbiAgICAgIGVtYWlsOiBbJycsIFtWYWxpZGF0b3JzLnJlcXVpcmVkLCBWYWxpZGF0b3JzLmVtYWlsXV0sXG4gICAgICBwYXNzd29yZDogWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZUF1dGhTbmFja2Jhck1lc3NhZ2VzKCk6IHZvaWQge1xuICAgIHRoaXMuYXV0aFByb2Nlc3MubWVzc2FnZU9uQXV0aFN1Y2Nlc3MgPSB0aGlzLm1lc3NhZ2VPbkF1dGhTdWNjZXNzO1xuICAgIHRoaXMuYXV0aFByb2Nlc3MubWVzc2FnZU9uQXV0aEVycm9yID0gdGhpcy5tZXNzYWdlT25BdXRoRXJyb3I7XG4gIH1cblxuICBhc3luYyBsb2dpbigpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoUHJvY2Vzcy5zaWduSW5XaXRoKHRoaXMuYXV0aFByb3ZpZGVycy5FbWFpbEFuZFBhc3N3b3JkLFxuICAgICAge1xuICAgICAgICBlbWFpbDogdGhpcy5sb2dpbkZvcm0uY29udHJvbHMuZW1haWwudmFsdWUsXG4gICAgICAgIHBhc3N3b3JkOiB0aGlzLmxvZ2luRm9ybS5jb250cm9scy5wYXNzd29yZC52YWx1ZVxuICAgICAgfVxuICAgICk7XG4gIH1cbn1cbiJdfQ==